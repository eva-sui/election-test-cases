# Trust the Vote ABC Schemas

## Setup/Installation

### Pre-requisites

To rebuild the data and/or you will need the following pre-requisites. Installation is dependent on your operating system.

- GNU Make >= 4 (for building everything)
- Python >= 3.6 (for building and validating samples)
- Pandoc >= 2.5 (for generating HTML notes)
- Node.js (for generating HTML annotations)

#### Python

1. Make sure you are on a system with Python >=3.6 installed.
2. Setup a Python virtual environment:

    ```
        python -m virtualenv .venv
        source .venv/bin/activate
    ```

3. Install the required packages:

    ```
        python -m pip install -r pip.requirements.txt
    ```

#### Node.js

1. Make sure you have Node.js installed.
2. Install the required packages.

    - Docco is needed to build the annotated CVR samples.

        ```
            npm --install docco
        ```

### Generating documents and samples

Use the Makefile to drive all tasks and tests.

Every rule that builds something starts with `build`. The equivalent name starting with `clean` will delete the files generated by the build.

#### Top-level Actions

To get a list of targets:

```
    make help
```

To build everything:

```
    make build
```

To clean everything:

```
    make clean
```

#### Reading the Notes

The notes are in `docs/notes`. To build them as HTML (results will be in the same directory)

```
    make notes
```

#### Building Samples

For all samples the results will be JSON files in `data/cvr/samples/*/*.json`.

To build all samples:

```
    make build-samples
```

To build the NIST samples:

```
    make build-nist-samples
```

To build our demo samples

```
    make build-minimal-samples
    make build-ny-1912-samples
```

#### Annotations

To generate the demo samples with annotations (note: You will need to install `docco` as noted above)

```
    make annotate
```

The results will be in `docs/annotated` as HTML files.

#### Validation

To validate files you will need to install the Pip requirements as noted above.

1. To validate all CVR files:

    ```
        make validate
    ```

2. To validate only JSON CVR files:

    ```
        make validate-cvr-json
    ```

3. To validate only XML CVR files:

    ```
        make validate-cvr-xml
    ```
